<!doctype html>
<html>
<head>
	<tc_include file="Public/TQHead"/>
</head>
	<body>
		<div class="mui-content">
			<form method="post" action="{:U('portal/user/modify')}">
					<if condition="$flg eq sex">
						<div class="mui-content">
							<div class="sec_row">
								<select id="sex" name="sex" class="sec_op">
									<if condition="$data eq 2">
										<option value="1">男</option>
										<option value="2" selected>女</option>
										<else />
										<option value="1" selected>男</option>
										<option value="2">女</option>
									</if>
								</select>
							</div>
						</div>
					<elseif condition="$flg eq healthy"/>
						<div class="mui-content">
							<notempty name="data">
								<div class="mui-input-row">
									<select name="healthy" id="healthy" onchange="setHealthy()">
										<foreach name="list" item="h">
											<option value="{$h.id}">{$h.name}</option>
										</foreach>
									</select>
								</div>
								<div class="mui-input-row" id="sec" style="display: none;">
									<select name="sec">
										<foreach name="slist" item="s">

										</foreach>
									</select>
								</div>
								<else />
								<div class="mui-input-row">
									<select name="healthy" id="healthy" onchange="setHealthy()">
										<foreach name="list" item="h">
											<option value="{$h.id}">{$h.name}</option>
										</foreach>
									</select>
								</div>
								<div class="mui-input-row" id="sec" style="display: none;">
									<select name="sec">
										<foreach name="slist" item="s">
											<if condition="$s.name eq $data">
												<option value="{$s.id}" selected>{$s.name}</option>
												<else />
												<option value="{$s.id}">{$s.name}</option>
											</if>
										</foreach>
									</select>
								</div>
							</notempty>
						</div>
					<elseif condition="$flg eq motion"/>
						<div class="mui-content">
							<div class="mui-input-row">
								<select name="motion">
									<notempty name="data">
										<if condition="$data eq '经常'">
											<option value="经常" selected>经常</option>
											<option value="有时">有时</option>
											<option value="几乎不">几乎不</option>
										</if>
										<if condition="$data eq '有时'">
											<option value="经常">经常</option>
											<option value="有时" selected>有时</option>
											<option value="几乎不">几乎不</option>
										</if>
										<if condition="$data eq '几乎不'">
											<option value="经常">经常</option>
											<option value="有时">有时</option>
											<option value="几乎不" selected>几乎不</option>
										</if>
										<else />
											<option value="经常" selected>经常</option>
											<option value="有时">有时</option>
											<option value="几乎不">几乎不</option>
									</notempty>
								</select>
							</div>
						</div>
					<elseif condition="$flg eq hospital"/>
						<div class="mui-content">
							<div class="mui-input-row">
								<select name="hospital">
									<foreach name="list" item="h">
										<if condition="$h.id eq $data">
											<option value="{$h.id}" selected>{$h.name}</option>
											<else />
											<option value="{$h.id}">{$h.name}</option>
										</if>
									</foreach>
								</select>
							</div>
						</div>
					<elseif condition="$flg eq office"/>
						<div class="mui-content">
							<div class="mui-input-row">
								<select name="office">
									<foreach name="list" item="h">
										<if condition="$h.id eq $data">
											<option value="{$h.id}" selected>{$h.name}</option>
											<else />
											<option value="{$h.id}">{$h.name}</option>
										</if>
									</foreach>
								</select>
							</div>
						</div>
					<elseif condition="$flg eq tag"/>
						<div class="mui-content">
							<div class="mui-input-row">
								<select name="tag">
									<foreach name="list" item="h">
										<if condition="$h.id eq $data">
											<option value="{$h.id}" selected>{$h.name}</option>
											<else />
											<option value="{$h.id}">{$h.name}</option>
										</if>
									</foreach>
								</select>
							</div>
						</div>
					<elseif condition="$flg eq position"/>
						<div class="mui-content">
							<div class="mui-input-row">
								<select name="position">
									<notempty name="data">
										<if condition="$data eq '主任医师'">
											<option value="主任医师" selected>主任医师</option>
											<option value="副主任医师">副主任医师</option>
											<option value="主治医师">主治医师</option>
										</if>
										<if condition="$data eq '副主任医师'">
											<option value="主任医师">主任医师</option>
											<option value="副主任医师" selected>副主任医师</option>
											<option value="主治医师">主治医师</option>
										</if>
										<if condition="$data eq '主治医师'">
											<option value="主任医师">主任医师</option>
											<option value="副主任医师">副主任医师</option>
											<option value="主治医师" selected>主治医师</option>
										</if>
										<else />
										<option value="主任医师" selected>主任医师</option>
										<option value="副主任医师">副主任医师</option>
										<option value="主治医师">主治医师</option>
									</notempty>
								</select>
							</div>
						</div>
					<else/>
					<div class="mui-content">
						<div class="mui-input-row">
							<notempty name="check">
								<textarea name="{$flg}" placeholder="请输入您的{$menu}" >{$data}</textarea>
								<else/>
								<input type="text" name="{$flg}" class="mui-input-clear" placeholder="请输入{$menu}" value="{$data}">
							</notempty>
						</div>
					</div>
				</if>
				<nav class="mui-bar mui-bar-tab">
					<div class="zixun-nav">
						<button type="submit" class="mui-pull-right" onclick="return check_form('{$flg}','{$menu}')">确认</button>
					</div>
				</nav>
			</form>
		</div>
	</body>
	<script type="text/javascript">
        $(function(){
            var str=$("#ck").val();
            if (str!=null&&str!=undefined&&str!=""&&str!="0"){
                var sel = $("#county");
                sel.css("display","block");
            }
        });
        function check_form(flg,menu) {
            if (flg == "sex" || flg == "healthy" || flg == "motion" || flg == "hospital" || flg == "office" || flg == "tag" || flg == "position"){
                var sex = $('#sex option:selected').val();
                var hospital = $('#hospital option:selected').val();
                var office = $('#office option:selected').val();
                var tag = $('#tag option:selected').val();
                var province = $('#province option:selected').val();
                var city = $('#city option:selected').val();
                if ((province.length!=0&&city.length!=0)||sex.length!=0||hospital.length!=0||office.length!=0||tag.length!=0){
                    return true;
                }else{
                    alert("请选择"+menu);
                    return false;
                }
            } else {
                var content = $("#"+flg).val();
                if (content.length!=0) {
                    return true;
                }else{
                    alert("请填写"+menu);
                    return false;
                }
            }
        }
        function setHealthy() {
            var cid = $('#city option:selected').val();
            $.ajax({
                async:false,
                type : "get",
                url : "index.php?g=portal&m=commonMethod&a=get_data",
                data : {
                    'pid' : cid,
                    'county' : 1
                },
                dataType : "json",
                success : function(data) {
                    var selct = $("#county");
                    selct.empty();
                    if(data.list.length > 0){
                        var list = data.list;
                        for (i=0;i<list.length;i++){
                            var county = list[i];
                            selct.append("<option value='"+county.id+"'>"+county.name+"</option>");
                        }
                        selct.css("display","block");
					}else{
                        selct.css("display","none");
                    }
                }
            });
        }
	</script>
</html>