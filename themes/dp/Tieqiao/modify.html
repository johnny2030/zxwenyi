<!doctype html>
<html>
<head>
	<tc_include file="Public/TQHead"/>
</head>
	<body>
		<div class="mui-content">
			<form method="post" action="{:U('portal/user/modify')}">
				<if condition="$flg eq sex">
					<div class="mui-content">
						<div class="sec_row">
							<select id="sex" name="sex" class="sec_op">
								<if condition="$data eq 2">
									<option value="1">男</option>
									<option value="2" selected>女</option>
									<else />
									<option value="1" selected>男</option>
									<option value="2">女</option>
								</if>
							</select>
						</div>
					</div>
					<elseif condition="$flg eq healthy"/>
						<div class="mui-content">
							<div class="mui-input-row">
								<notempty name="data">
									<if condition="$data eq '无病'">
										<select name="healthy" onchange="set_ill()">
											<option value="无疾病" selected>无疾病</option>
											<option value="有疾病">有疾病</option>
										</select>
										<else />
										<select name="healthy" onchange="set_ill()">
											<option value="无疾病">无疾病</option>
											<option value="有疾病"selected>有疾病</option>
										</select>
										<select name="ill">
											<option value="肩周炎"selected>肩周炎</option>
											<option value="白内障">白内障</option>
											<option value="其他疾病">其他疾病</option>
										</select>
									</if>
									<else />
										<select name="healthy" onchange="set_ill()">
											<option value="无疾病" selected>无疾病</option>
											<option value="有疾病">有疾病</option>
										</select>
								</notempty>
							</div>
						</div>
					<elseif condition="$flg eq motion"/>
						<div class="mui-content">
							<div class="mui-input-row">
								<select name="motion">
									<notempty name="data">
										<if condition="$data eq '经常'">
											<option value="经常" selected>经常</option>
											<option value="有时">有时</option>
											<option value="几乎不">几乎不</option>
										</if>
										<if condition="$data eq '有时'">
											<option value="经常">经常</option>
											<option value="有时" selected>有时</option>
											<option value="几乎不">几乎不</option>
										</if>
										<if condition="$data eq '几乎不'">
											<option value="经常">经常</option>
											<option value="有时">有时</option>
											<option value="几乎不" selected>几乎不</option>
										</if>
										<else />
											<option value="经常" selected>经常</option>
											<option value="有时">有时</option>
											<option value="几乎不">几乎不</option>
									</notempty>
								</select>
							</div>
						</div>
					<elseif condition="$flg eq hospital"/>
						<div class="mui-content">
							<div class="mui-input-row">
								<select name="hospital">
									<foreach name="list" item="h">
										<if condition="$h.id eq $data">
											<option value="{$h.id}" selected>{$h.name}</option>
											<else />
											<option value="{$h.id}">{$h.name}</option>
										</if>
									</foreach>
								</select>
							</div>
						</div>
					<elseif condition="$flg eq office"/>
						<div class="mui-content">
							<div class="mui-input-row">
								<select name="office">
									<foreach name="list" item="h">
										<if condition="$h.id eq $data">
											<option value="{$h.id}" selected>{$h.name}</option>
											<else />
											<option value="{$h.id}">{$h.name}</option>
										</if>
									</foreach>
								</select>
							</div>
						</div>
					<elseif condition="$flg eq tag"/>
						<div class="mui-content">
							<div class="mui-input-row">
								<select name="tag">
									<foreach name="list" item="h">
										<if condition="$h.id eq $data">
											<option value="{$h.id}" selected>{$h.name}</option>
											<else />
											<option value="{$h.id}">{$h.name}</option>
										</if>
									</foreach>
								</select>
							</div>
						</div>
					<elseif condition="$flg eq position"/>
						<div class="mui-content">
							<div class="mui-input-row">
								<select name="position">
									<notempty name="data">
										<if condition="$data eq '主任医师'">
											<option value="主任医师" selected>主任医师</option>
											<option value="副主任医师">副主任医师</option>
											<option value="主治医师">主治医师</option>
										</if>
										<if condition="$data eq '副主任医师'">
											<option value="主任医师">主任医师</option>
											<option value="副主任医师" selected>副主任医师</option>
											<option value="主治医师">主治医师</option>
										</if>
										<if condition="$data eq '主治医师'">
											<option value="主任医师">主任医师</option>
											<option value="副主任医师">副主任医师</option>
											<option value="主治医师" selected>主治医师</option>
										</if>
										<else />
										<option value="主任医师" selected>主任医师</option>
										<option value="副主任医师">副主任医师</option>
										<option value="主治医师">主治医师</option>
									</notempty>
								</select>
							</div>
						</div>
					<else/>
					<div class="mui-content">
						<div class="mui-input-row">
							<notempty name="check">
								<textarea name="{$flg}" placeholder="请输入您的{$menu}" >{$data}</textarea>
								<else/>
								<input type="text" name="{$flg}" class="mui-input-clear" placeholder="请输入{$menu}" value="{$data}">
							</notempty>
						</div>
					</div>
				</if>
				<nav class="mui-bar mui-bar-tab">
					<div class="zixun-nav">
						<button type="submit" class="mui-pull-right" onclick="return check_form('{$flg}','{$menu}')">确认</button>
					</div>
				</nav>
			</form>
		</div>
	</body>
	<script type="text/javascript">
        $(function(){
            var str=$("#ck").val();
            if (str!=null&&str!=undefined&&str!=""&&str!="0"){
                var sel = $("#county");
                sel.css("display","block");
            }
        });
        function check_form(flg,menu) {
            if (flg == "area" || flg == "sex" || flg == "hospital" || flg == "office" || flg == "tag"){
                var sex = $('#sex option:selected').val();
                var hospital = $('#hospital option:selected').val();
                var office = $('#office option:selected').val();
                var tag = $('#tag option:selected').val();
                var province = $('#province option:selected').val();
                var city = $('#city option:selected').val();
                if ((province.length!=0&&city.length!=0)||sex.length!=0||hospital.length!=0||office.length!=0||tag.length!=0){
                    return true;
                }else{
                    alert("请选择"+menu);
                    return false;
                }
            } else {
                var content = $("#"+flg).val();
                if (content.length!=0) {
                    return true;
                }else{
                    alert("请填写"+menu);
                    return false;
                }
            }
        }
        function setCity() {
            var pid = $('#province option:selected').val();
            $.ajax({
                async:false,
                type : "get",
                url : "index.php?g=portal&m=commonMethod&a=get_data",
                data : {'pid' : pid},
                dataType : "json",
                success : function(data) {
                    var list = data.list;
                    var selct = $("#city");
                    selct.empty();
                    for (i=0;i<list.length;i++){
                        var city = list[i];
                        selct.append("<option value='"+city.id+"'>"+city.name+"</option>");
					}
					var coty = list[0];
                    $.ajax({
                        async:false,
                        type : "get",
                        url : "index.php?g=portal&m=commonMethod&a=get_data",
                        data : {
                            'pid' : coty.id,
                            'county' : 1
						},
                        dataType : "json",
                        success : function(dta) {
                            var sel = $("#county");
                            sel.empty();
                            if(dta.list.length > 0){
                                var list = dta.list;
                                for (i=0;i<list.length;i++){
                                    var county = list[i];
                                    sel.append("<option value='"+county.id+"'>"+county.name+"</option>");
                                }
                                sel.css("display","block");
                            }else{
                                sel.css("display","none");
							}
                        }
                    });
                }
            });
        }
        function setCounty() {
            var cid = $('#city option:selected').val();
            $.ajax({
                async:false,
                type : "get",
                url : "index.php?g=portal&m=commonMethod&a=get_data",
                data : {
                    'pid' : cid,
                    'county' : 1
                },
                dataType : "json",
                success : function(data) {
                    var selct = $("#county");
                    selct.empty();
                    if(data.list.length > 0){
                        var list = data.list;
                        for (i=0;i<list.length;i++){
                            var county = list[i];
                            selct.append("<option value='"+county.id+"'>"+county.name+"</option>");
                        }
                        selct.css("display","block");
					}else{
                        selct.css("display","none");
                    }
                }
            });
        }
	</script>
</html>