<!doctype html>
<html>
<head>
	<tc_include file="Public/TQHead"/>
</head>
<body>
<div class="mui-content">
	<header id="header" class="mui-bar mui-bar-nav">
		<img src="__TMPL__Public/images/logo.jpg" class="head-img">
		<h1 class="mui-title">医生注册</h1>
	</header>
	<form action="{:U('portal/index/register_doctor')}">
		<div class="mui-content-padded" style="margin-top: 4rem;">
			<div class="mui-input-row">
				<input type="text" id="name" name="name" class="u-inpt u-name mui-input-clear" placeholder="请输入用户姓名" value="">
			</div>
			<div class="mui-input-row">
				<input type="text" id="unit" name="unit" class="u-inpt c-job mui-input-clear" placeholder="请输入单位" value="">
			</div>
			<div class="mui-input-row">
				<select id="position" name="position" class="u-inpt pt-sel">
					<option value="" selected>请选择职位</option>
					<option value="主任医师">主任医师</option>
					<option value="副主任医师">副主任医师</option>
					<option value="主治医师">主治医师</option>
					<!--<foreach name="plist" item="h">
						<option value="{$h.name}">{$h.name}</option>
					</foreach>-->
				</select>
			</div>
			<div class="mui-input-row">
				<select id="office" name="office" class="u-inpt of-sel">
					<option value="" selected>请选择科室</option>
					<foreach name="olist" item="o">
						<option value="{$o.id}">{$o.name}</option>
					</foreach>
				</select>
			</div>
			<div class="mui-input-row">
				<select id="tag" name="tag" class="u-inpt tg-sel">
					<option value="" selected>请选择具体科室</option>
					<foreach name="tlist" item="t">
						<option value="{$t.id}">{$t.name}</option>
					</foreach>
				</select>
			</div>
			<div class="mui-input-row">
				<input type="password" id="pwd" name="pwd" class="u-inpt u-pwd mui-input-password" placeholder="请设置密码" value="">
			</div>
			<div class="mui-input-row">
				<input type="password" id="pwds" name="pwds" class="u-inpt u-pwd-agn mui-input-password" placeholder="请确认密码" value="">
			</div>
			<div class="mui-input-row">
				<input type="text" id="phone" name="phone" class="u-inpt u-phone mui-input-clear" placeholder="请输入手机号码" value="">
			</div>
			<div class="mui-input-row">
				<input type="text" id="v_code" name="v_code" class="u-inpt v-code mui-input-clear" placeholder="请输入验证码" value="">
				<button type="button" class="mui-btn mui-btn-primary v-code-btn">获取验证码</button>
			</div>
			<div class="mui-button-row">
				<button type="submit" class="mui-btn mui-btn-primary footer-btn" onclick="return check_form();">确认</button>&nbsp;&nbsp;
				<button type="button" class="mui-btn mui-btn-danger footer-btn" onclick="return false;">取消</button>
			</div>
		</div>
	</form>
</div>
</body>
<script type="text/javascript">
    function check_form() {
        if(check_name()){
            return false;
        }else if(check_unit()){
            return false;
        }else if(check_position()){
            return false;
        }else if(check_office()){
            return false;
        }else if(check_tag()){
            return false;
        }else if(check_pwd()){
            return false;
        }else if(check_pwds()){
            return false;
        }else if(vailPhone()){
            return false;
        }else {
            return true;
        }
    }
    function check_name(){
        var name = $("#name").val();
        if (name.length==0){
            alert("用户姓名不能为空！");
            $("#name").css("border-color","red");
            return false;
        } else{
            $("#name").css("border-color","");
            return true;
        }
    }
    function check_unit(){
        var unit = $("#unit").val();
        if (unit.length==0){
            alert("单位不能为空！");
            $("#unit").css("border-color","red");
            return false;
        } else{
            $("#unit").css("border-color","");
            return true;
        }
    }
    function check_position(){
        var position = $('#position option:selected').val();
        if (position.length==0){
            alert("请选择职位！");
            $("#position").css("border-color","red");
            return false;
        } else{
            $("#position").css("border-color","");
            return true;
        }
    }
    function check_office(){
        var office = $('#office option:selected').val();
        if (office.length==0){
            alert("请选择科室！");
            $("#office").css("border-color","red");
            return false;
        } else{
            $("#office").css("border-color","");
            return true;
        }
    }
    function check_tag(){
        var tag = $('#tag option:selected').val();
        if (tag.length==0){
            alert("请选择具体科室！");
            $("#tag").css("border-color","red");
            return false;
        } else{
            $("#tag").css("border-color","");
            return true;
        }
    }
    function check_pwd(){
        var pwd = $("#pwd").val();
        var pwds = $("#pwds").val();
        if (pwd.length==0){
            alert("密码不能为空！");
            $("#pwd").css("border-color","red");
            return false;
        } else if (pwds.length>0){
            if (pwd != pwds){
                alert("密码与确认密码不同！");
                $("#pwd").css("border-color","red");
                $("#pwds").css("border-color","red");
            }else{
                $("#pwd").css("border-color","");
                $("#pwds").css("border-color","");
            }
        } else{
            $("#pwd").css("border-color","");
            return true;
        }
    }
    function check_pwds(){
        var pwd = $("#pwd").val();
        var pwds = $("#pwds").val();
        if (pwds.length==0){
            alert("确认密码不能为空！");
            $("#pwds").css("border-color","red");
            return false;
        } else if (pwd.length>0){
            if (pwd != pwds){
                alert("密码与确认密码不同！");
                $("#pwd").css("border-color","red");
                $("#pwds").css("border-color","red");
            }else{
                $("#pwd").css("border-color","");
                $("#pwds").css("border-color","");
            }
        } else{
            $("#pwds").css("border-color","");
            return true;
        }
    }
    function vailPhone(){
        var phone = $("#phone").val();
        var flag = false;
        var myreg = /^1[34578]\d{9}$/;
        if(phone.length == 0){
            alert("手机号码不能为空！");
        }else if(phone.length !=11){
            alert("请输入有效的手机号码！");
        }else if(!myreg.test(phone)){
            alert("请输入有效的手机号码！");
        }else if(check_phone()){
            alert("该手机号已经注册！");
		}else{
            flag = true;
            $("#phone").css("border-color","");
        }
        if(!flag){
            $("#phone").css("border-color","red");
        }
        return flag;
    }
    function check_phone() {
        var phone = $("#phone").val();
        $.ajax({
            async:false,
            type : "get",
            url : "index.php?g=portal&m=commonMethod&a=check_phone",
            data : {
                'phone' : phone
            },
            dataType : "json",
            success : function(data) {
                if (data == 0){
                    return true;
                } else {
                    return false;
                }
            }
        });
    }
</script>
</html>